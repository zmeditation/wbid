pbjsChunk([292],{314:function(e,t,r){e.exports=r(315)},315:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"emxAdapter",(function(){return f})),r.d(t,"spec",(function(){return v}));var i=r(0),n=r(1),a=r(2),d=r(13),o=r(12),s=r.n(o),u=r(11),c=r.n(u);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}var l="emx_digital",g="https://js.brealtime.com/outstream/1.30.0/bundle.js",m="USD",b=[{key:"idl_env",source:"liveramp.com",rtiPartner:"idl",queryParam:"idl"},{key:"uid2.id",source:"uidapi.com",rtiPartner:"UID2",queryParam:"uid2"}],f={validateSizes:function(e){return Object(i.isArray)(e)&&void 0!==e[0]?e.every((function(e){return Object(i.isArray)(e)&&2===e.length})):(Object(i.logWarn)("emx_digital: Sizes should be an array"),!1)},checkVideoContext:function(e){return e&&e.mediaTypes&&e.mediaTypes.video&&e.mediaTypes.video.context&&("instream"===e.mediaTypes.video.context||"outstream"===e.mediaTypes.video.context)},buildBanner:function(e){var t=[];return t=e.mediaTypes&&e.mediaTypes.banner&&e.mediaTypes.banner.sizes?e.mediaTypes.banner.sizes:e.sizes,f.validateSizes(t)||(Object(i.logWarn)("emx_digital: could not detect mediaType banner sizes. Assigning to bid sizes instead"),t=e.sizes),{format:t.map((function(e){return{w:e[0],h:e[1]}})),w:t[0][0],h:t[0][1]}},formatVideoResponse:function(e,t,r){(e.vastXml=t.adm,r.bidderRequest&&r.bidderRequest.bids&&r.bidderRequest.bids.length>0)&&(c()(r.bidderRequest.bids,(function(t){return e.requestId&&t.bidId&&e.requestId===t.bidId&&t.mediaTypes&&t.mediaTypes.video&&"outstream"===t.mediaTypes.video.context}))&&(e.renderer=f.createRenderer(e,{id:t.id,url:g})));return e},isMobile:function(){return/(ios|ipod|ipad|iphone|android)/i.test(navigator.userAgent)},isConnectedTV:function(){return/(smart[-]?tv|hbbtv|appletv|googletv|hdmi|netcast\.tv|viera|nettv|roku|\bdtv\b|sonydtv|inettvbrowser|\btv\b)/i.test(navigator.userAgent)},getDevice:function(){return{ua:navigator.userAgent,js:1,dnt:"yes"===navigator.doNotTrack||"1"===navigator.doNotTrack||"1"===navigator.msDoNotTrack?1:0,h:screen.height,w:screen.width,devicetype:f.isMobile()?1:f.isConnectedTV()?3:2,language:navigator.language||navigator.browserLanguage||navigator.userLanguage||navigator.systemLanguage}},cleanProtocols:function(e){return e.protocols&&s()(e.protocols,7)&&(Object(i.logWarn)("emx_digital: VAST 4.0 is currently not supported. This protocol has been filtered out of the request."),e.protocols=e.protocols.filter((function(e){return 7!==e}))),e},outstreamRender:function(e){e.renderer.push((function(){var t=e&&e.params&&e.params[0]&&e.params[0].video?e.params[0].video:{};window.emxVideoQueue=window.emxVideoQueue||[],window.queueEmxVideo({id:e.adUnitCode,adsResponses:e.vastXml,options:t}),window.emxVideoReady&&window.videojs&&window.emxVideoReady()}))},createRenderer:function(e,t){var r=d.a.install({id:t.id,url:g,loaded:!1});try{r.setRender(f.outstreamRender)}catch(e){Object(i.logWarn)("Prebid Error calling setRender on renderer",e)}return r},buildVideo:function(e){var t=p(e.mediaTypes.video,e.params.video);return Object(i.isArray)(e.mediaTypes.video.playerSize[0])?(t.w=e.mediaTypes.video.playerSize[0][0],t.h=e.mediaTypes.video.playerSize[0][1]):(t.w=e.mediaTypes.video.playerSize[0],t.h=e.mediaTypes.video.playerSize[1]),f.cleanProtocols(t)},parseResponse:function(e){try{return decodeURIComponent(e.replace(/%(?![0-9][0-9a-fA-F]+)/g,"%25"))}catch(e){Object(i.logError)("emx_digitalBidAdapter","error",e)}},getReferrer:function(){try{return window.top.document.referrer}catch(e){return document.referrer}},getSite:function(e){return{domain:Object(i.parseUrl)(e.referer).hostname,page:e.referer,ref:f.getReferrer()}},getGdpr:function(e,t){return e.gdprConsent&&(t.regs={ext:{gdpr:!0===e.gdprConsent.gdprApplies?1:0}}),e.gdprConsent&&e.gdprConsent.gdprApplies&&(t.user={ext:{consent:e.gdprConsent.consentString}}),t},getSupplyChain:function(e,t){return e.bids[0]&&e.bids[0].schain&&(t.source={ext:{schain:e.bids[0].schain}}),t},getEids:function(e){return b.map(f.getUserId(e)).filter((function(e){return e}))},getUserId:function(e){return function(t){var r=t.key,n=t.source,a=t.rtiPartner,d=Object(i.deepAccess)(e,"userId.".concat(r));return d?f.formatEid(d,n,a):null}},formatEid:function(e,t,r){return{source:t,uids:[{id:e,ext:{rtiPartner:r}}]}}},v={code:l,gvlid:183,supportedMediaTypes:[a.b,a.d],isBidRequestValid:function(e){if(!e||!e.params)return Object(i.logWarn)("emx_digital: Missing bid or bid params."),!1;if(e.bidder!==l)return Object(i.logWarn)('emx_digital: Must use "emx_digital" as bidder code.'),!1;if(!e.params.tagid||!Object(i.isStr)(e.params.tagid))return Object(i.logWarn)("emx_digital: Missing tagid param or tagid present and not type String."),!1;var t;if(e.mediaTypes&&e.mediaTypes.banner){if(t=e.mediaTypes.banner.sizes?e.mediaTypes.banner.sizes:e.sizes,!f.validateSizes(t))return Object(i.logWarn)("emx_digital: Missing sizes in bid"),!1}else if(e.mediaTypes&&e.mediaTypes.video){if(!f.checkVideoContext(e))return Object(i.logWarn)("emx_digital: Missing video context: instream or outstream"),!1;if(!e.mediaTypes.video.playerSize)return Object(i.logWarn)("emx_digital: Missing video playerSize"),!1}return!0},buildRequests:function(e,t){var r=[],n="https://hb.emxdgt.com?t="+(t.timeout||"")+"&ts="+Date.now()+"&src=pbjs",a=location.protocol.indexOf("https")>-1?1:0,d=f.getDevice(),o=f.getSite(t.refererInfo);Object(i._each)(e,(function(e){var t=Object(i.getBidIdParameter)("tagid",e.params),n=parseFloat(function(e){if(!Object(i.isFn)(e.getFloor))return parseFloat(Object(i.getBidIdParameter)("bidfloor",e.params));var t=e.getFloor({currency:m,mediaType:"*",size:"*"});if(Object(i.isPlainObject)(t)&&!isNaN(t.floor)&&"USD"===t.currency)return t.floor;return null}(e))||0,d=!!e.mediaTypes.video,o={id:e.bidId,tid:e.transactionId,tagid:t,secure:a},s=Object(i.deepAccess)(e,"ortb2Imp.ext.data.adserver.adslot");s||(s=Object(i.deepAccess)(e,"ortb2Imp.ext.data.pbadslot")),s&&(o.ext={gpid:s.toString()});var u=p(o,d?{video:f.buildVideo(e)}:{banner:f.buildBanner(e)},n>0?{bidfloor:n,bidfloorcur:m}:{});r.push(u)}));var s={id:t.auctionId,imp:r,device:d,site:o,cur:m,version:"1.5.1"};if(s=f.getGdpr(t,p({},s)),s=f.getSupplyChain(t,p({},s)),t&&t.uspConsent&&(s.us_privacy=t.uspConsent),t.userId){var u=f.getEids(t);u.length>0&&(s.user&&s.user.ext?s.user.ext.eids=u:s.user={ext:{eids:u}})}return{method:"POST",url:n,data:JSON.stringify(s),options:{withCredentials:!0},bidderRequest:t}},interpretResponse:function(e,t){var r=[],i=e.body||{};return i.seatbid&&i.seatbid.length>0&&i.seatbid[0].bid&&i.seatbid.forEach((function(e){e=e.bid[0];var i=!1,n=f.parseResponse(e.adm)||"",d={requestId:e.id,cpm:e.price,width:e.w,height:e.h,creativeId:e.crid||e.id,dealId:e.dealid||null,currency:"USD",netRevenue:!0,ttl:e.ttl,ad:n};e.adm&&e.adm.indexOf("<?xml version=")>-1&&(i=!0,d=f.formatVideoResponse(d,p({},e),t)),d.mediaType=i?a.d:a.b,e.adomain&&e.adomain.length&&(d.meta={advertiserDomains:e.adomain}),r.push(d)})),r},getUserSyncs:function(e,t,r,i){var n=[];if(e.iframeEnabled){var a="https://biddr.brealtime.com/check.html";r&&"string"==typeof r.consentString&&("boolean"==typeof r.gdprApplies?a+="?gdpr=".concat(Number(r.gdprApplies),"&gdpr_consent=").concat(r.consentString):a+="?gdpr_consent=".concat(r.consentString)),n.push({type:"iframe",url:a})}return n}};Object(n.registerBidder)(v),window.pbjs.installedModules.push("emx_digitalBidAdapter")}},[314]);