pbjsChunk([228],{396:function(t,i,e){t.exports=e(397)},397:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.surfaceTestHook=k,e.d(i,"digiTrustIdSubmodule",function(){return h});var l=e(0),a=e(4),n=e(13),r=e(9),u=Object(r.b)(64),o=0;function s(){return null!=window.DigiTrust&&DigiTrust.isClient}var d=function(){},c=2,f="https://prebid.digitru.st/id/v1",g=function(t){return"function"==typeof t},b=null;function m(t){var i=new Date;i.setTime(i.getTime()+6048e5),u.setCookie("DigiTrust.v1.identity",function(i){try{return"string"!=typeof i&&(i=JSON.stringify(i)),btoa(i)}catch(t){return i}}(t),i.toUTCString(),"none")}function T(){return l.isSafariBrowser()||-1!==(t=(t=t||navigator.userAgent).toLowerCase()).indexOf("firefox");var t}function v(t){clearTimeout(o);var c={isClient:!(o=0),isMock:!0,_internals:{callCount:0,initCallback:null},getUser:function(t,i){var e=!!g(i),n=e?i:d,r={success:!1},u=c._internals;u.callCount++;function o(t){if(u.callCount<=1&&g(u.initCallback))try{u.initCallback(t)}catch(t){l.logError("Exception in passed DigiTrust init callback",t)}}if(!p(t.member))return e?void n(r):r;if(null!=b)return e?void o(b):b;var s={success:function(t){var i={success:!0};try{i.identity=JSON.parse(t),b=i,m(t)}catch(t){i.success=!1,delete i.identity}o(i)},fail:function(t){l.logError("DigiTrustId API error: "+t)}};return w.hasConsent(null,function(t){if(t){if(T()){return void o({success:!1,err:"Your browser does not support DigiTrust Identity"})}i=s,Object(a.a)(f,{success:i.success,error:i.fail},null,{method:"GET",withCredentials:!0})}var i}),e?void 0:r}};t&&g(t.callback)&&(c._internals.initCallback=t.callback),window&&null==window.DigiTrust&&(window.DigiTrust=c)}var p=function(t){return!!(t&&0<t.length)||(l.logError("[DigiTrust Prebid Client Error] Missing member ID, add the member ID to the function call options"),!1)},w={hasConsent:function(t,e){var n;t=t||{consentTimeout:1500};var r=!1,i=!1;void 0!==window.__cmp?(n=setTimeout(function(){r=!(i=!1),e(i)},t.consentTimeout),window.__cmp("ping",null,function(t){if(t.gdprAppliesGlobally)window.__cmp("getVendorConsents",[64],function(t){if(!r){clearTimeout(n);var i=t.vendorConsents[64];e(i)}});else{if(r)return;clearTimeout(n),e(i=!0)}})):e(i=!0)}},I=new function(){var e=this,n=this.idObj=null;function r(){if(null==e.idObj&&(e.idObj=b),null==e.idObj)return null;var t=e.configParams,i={data:null,expires:t&&t.storage&&t.storage.expires||60};return e.idObj&&e.idObj.success&&e.idObj.identity?i.data=e.idObj.identity:i.err="Failure getting id",i}this.userIdCallback=function(t){n=t,null==e.idObj&&(e.idObj=b),null!=e.idObj&&g(t)&&t(r())},this.retries=0,this.retryId=0,this.executeIdRequest=function(i){DigiTrust.getUser({member:"prebid"},function(t){e.idObj=t;if(g(n)&&n(r()),i&&i.callback&&g(i.callback))try{i.callback(t)}catch(t){l.logError("Failure in DigiTrust executeIdRequest",t)}})}};function y(t){return null==I.configParams&&(I.configParams=t),null==window.DigiTrust||s()?s()?I.executeIdRequest(t):I.retries>=c?(v(t),I.executeIdRequest(t)):(0!=I.retryId&&clearTimeout(I.retryId),I.retryId=setTimeout(function(){y(t)},100*(1+I.retries++))):(function(t){l.logInfo("Digitrust Init");var i=window.DigiTrust;i&&!i.isClient&&null!=t?i.initialize(t.init,t.callback):null==i&&v(t)}(t),I.retryId=setTimeout(function(){y(t)},100*(1+I.retries++))),I.userIdCallback}var C={};function k(){return h._testHook=C}C.initDigitrustFacade=v,C.gdpr=w;var h={name:"digitrust",decode:function(t){try{return{digitrustid:t}}catch(t){l.logError("DigiTrust ID submodule decode error")}},getId:function(t){return{callback:y(t)}},_testInit:k};o=setTimeout(function(){0!=I.retryId||s()||y({member:"fallback",callback:d})},1550),Object(n.e)("userId",h)}},[396]);