pbjsChunk([286],{330:function(r,e,n){r.exports=n(331)},331:function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"fabrickIdSubmodule",(function(){return i})),e.appendUrl=u;var t=n(0),c=n(4),a=n(8),o=n(18),i={name:"fabrickId",decode:function(r){return r&&r.fabrickId?{fabrickId:r.fabrickId}:void 0},getId:function(r,e,n){try{var a=r&&r.params||{};if(window.fabrickMod1&&window.fabrickMod1(a,e,n),!a||!a.apiKey||"string"!=typeof a.apiKey)return void Object(t.logError)("fabrick submodule requires an apiKey.");try{var i=function(r){return r.url?r.url:"https://fid.agkn.com/f?"}(a),s=Object.keys(a);for(var d in s){var l=s[d];if(!("url"===l||"refererInfo"===l||l.length>3&&"max"===l.substring(0,3))){var b=a[l];if(Array.isArray(b))for(var g in b)"string"!=typeof b[g]&&"number"!=typeof b[g]||(i+="".concat(l,"=").concat(b[g],"&"));else"string"!=typeof b&&"number"!=typeof b||(i+="".concat(l,"=").concat(b,"&"))}}i=i.slice(0,-1);var h=function(r){return r.refererInfo?r.refererInfo:Object(o.a)()}(a),p=new Map;f(p,h.referer),h.stack&&h.stack[0]&&f(p,h.stack[0]),f(p,h.canonicalUrl),f(p,window.location.href),p.forEach((function(r){i=u(i,"r",r,a)}));return{callback:function(r){var o={success:function(c){if(window.fabrickMod2)return window.fabrickMod2(r,c,a,e,n);var o;if(c)try{o=JSON.parse(c)}catch(r){Object(t.logError)(r),o={}}r(o)},error:function(e){Object(t.logError)("fabrickId fetch encountered an error",e),r()}};Object(c.a)(i,o,null,{method:"GET",withCredentials:!0})}}}catch(r){Object(t.logError)("fabrickIdSystem encountered an error",r)}}catch(r){Object(t.logError)("fabrickIdSystem encountered an error",r)}}};function f(r,e){if(e){var n=e.split("?")[0];if(r.has(n)){var t=r.get(n);e.length>t.length&&r.set(n,e)}else r.set(n,e)}}function u(r,e,n,t){var c=t&&t.maxUrlLen||2e3,a=t&&t.maxRefLen||1e3,o=t&&t.maxSpaceAvailable||50;if(n&&r.length<c-o){var i=c-r.length;return i>a&&(i=a),(n="&".concat(e,"=").concat(encodeURIComponent(n))).length>=i&&("%"===(n=n.substring(0,i)).charAt(n.length-1)?n=n.substring(0,i-1):"%"===n.charAt(n.length-2)&&(n=n.substring(0,i-2))),"".concat(r).concat(n)}return r}Object(a.e)("userId",i),window.pbjs.installedModules.push("fabrickIdSystem")}},[330]);