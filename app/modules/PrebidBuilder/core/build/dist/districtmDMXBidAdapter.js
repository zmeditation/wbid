pbjsChunk([298],{304:function(e,r,t){e.exports=t(305)},305:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),t.d(r,"spec",(function(){return h})),r.getFloor=g,r.cleanSizes=v,r.shuffle=O,r.removeDuplicate=A,r.upto5=I,r.matchRequest=j,r.checkDeepArray=S,r.defaultSize=x,r.bindUserId=w,r.getApi=T,r.getPlaybackmethod=function(e){if(Array.isArray(e)&&e.length>0)return e.map((function(e){return b.playback_method[e]}));return[2]},r.getProtocols=z,r.cleanVast=_;var n=t(0),i=t(1),o=t(3),s=t(2);function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,i,o=[],s=!0,a=!1;try{for(t=t.call(e);!(s=(n=t.next()).done)&&(o.push(n.value),!r||o.length!==r);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==t.return||t.return()}finally{if(a)throw i}}return o}(e,r)||u(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,r){if(e){if("string"==typeof e)return d(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?d(e,r):void 0}}function d(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach((function(r){f(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function f(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var y="https://dmx.districtm.io/b/v1",b={playback_method:{auto_play_sound_on:1,auto_play_sound_off:2,click_to_play:3,mouse_over:4,viewport_sound_on:5,viewport_sound_off:6}},h={code:"districtmDMX",gvlid:144,aliases:["dmx"],supportedFormat:[s.b,s.d],supportedMediaTypes:[s.d,s.b],isBidRequestValid:function(e){return!!e.params.memberid},interpretResponse:function(e,r){return(e=e.body||{}).seatbid&&Object(n.isArray)(e.seatbid)?e.seatbid.reduce((function(e,t){var n=t.bid.reduce((function(e,t){if(e.price<t.price){var n=j(t.impid,r),i=x(n),o=i.width,s=i.height;return t.cpm=parseFloat(t.price).toFixed(2),t.bidId=t.impid,t.requestId=t.impid,t.width=t.w||o,t.height=t.h||s,t.ttl=300,t.mediaType=n.mediaTypes&&n.mediaTypes.video?"video":"banner","video"===t.mediaType&&(t.vastXml=_(t.adm,t.nurl),t.ttl=3600),t.dealid&&(t.dealId=t.dealid),t.uuid=t.bidId,t.ad=t.adm,t.netRevenue=!0,t.creativeId=t.crid,t.currency="USD",t.meta=t.meta||{},t.adomain&&t.adomain.length>0&&(t.meta.advertiserDomains=t.adomain),t}return e.cpm=e.price,e}),{price:0});return n.adm&&e.push(n),e}),[]).filter((function(e){return!!e.bidId})):[]},buildRequests:function(e,r){var t=o.b.getConfig("bidderTimeout"),i=null,s={id:Object(n.generateUUID)(),cur:["USD"],tmax:t-300,test:this.test()||0,site:{publisher:{id:String(e[0].params.memberid)||null}}};try{var a=o.b.getConfig("dmx");s.user=a.user||{};var c=a.site||{};s.site=m(m({},s.site),c)}catch(e){}var u=[];e[0]&&e[0].userId&&(w(u,Object(n.deepAccess)(e[0],"userId.idl_env"),"liveramp.com",1),w(u,Object(n.deepAccess)(e[0],"userId.id5id.uid"),"id5-sync.com",1),w(u,Object(n.deepAccess)(e[0],"userId.pubcid"),"pubcid.org",1),w(u,Object(n.deepAccess)(e[0],"userId.tdid"),"adserver.org",1),w(u,Object(n.deepAccess)(e[0],"userId.criteoId"),"criteo.com",1),w(u,Object(n.deepAccess)(e[0],"userId.britepoolid"),"britepool.com",1),w(u,Object(n.deepAccess)(e[0],"userId.lipb.lipbid"),"liveintent.com",1),w(u,Object(n.deepAccess)(e[0],"userId.intentiqid"),"intentiq.com",1),w(u,Object(n.deepAccess)(e[0],"userId.lotamePanoramaId"),"lotame.com",1),w(u,Object(n.deepAccess)(e[0],"userId.parrableId"),"parrable.com",1),w(u,Object(n.deepAccess)(e[0],"userId.netId"),"netid.de",1),s.user=s.user||{},s.user.ext=s.user.ext||{},s.user.ext.eids=u),s.test||delete s.test,r.gdprConsent&&(s.regs={},s.regs.ext={},s.regs.ext.gdpr=!0===r.gdprConsent.gdprApplies?1:0,!0===r.gdprConsent.gdprApplies&&(s.user={},s.user.ext={},s.user.ext.consent=r.gdprConsent.consentString)),s.regs=s.regs||{},s.regs.coppa=!0===o.b.getConfig("coppa")?1:0,r&&r.uspConsent&&(s.regs=s.regs||{},s.regs.ext=s.regs.ext||{},s.regs.ext.us_privacy=r.uspConsent);try{i=e[0].schain,s.source={},s.source.ext={},s.source.ext.schain=i||{}}catch(e){}var d=e.map((function(e){var r={};return r.id=e.bidId,r.tagid=String(e.params.dmxid||e.adUnitCode),r.secure=1,r.bidfloor=g(e),e.mediaTypes&&e.mediaTypes.video?r.video={topframe:1,skip:e.mediaTypes.video.skip||0,linearity:e.mediaTypes.video.linearity||1,minduration:e.mediaTypes.video.minduration||5,maxduration:e.mediaTypes.video.maxduration||60,playbackmethod:e.mediaTypes.video.playbackmethod||[2],api:T(e.mediaTypes.video),mimes:e.mediaTypes.video.mimes||["video/mp4"],protocols:z(e.mediaTypes.video),h:e.mediaTypes.video.playerSize[0][1],w:e.mediaTypes.video.playerSize[0][0]}:r.banner={topframe:1,w:v(e.sizes,"w"),h:v(e.sizes,"h"),format:v(e.sizes).map((function(e){return{w:e[0],h:e[1]}})).filter((function(e){return"number"==typeof e.w&&"number"==typeof e.h}))},r}));return d.length<=5?(s.imp=d,{method:"POST",url:y,data:JSON.stringify(s),bidderRequest:r}):I(d,s,r,y)},test:function(){return-1!==window.location.href.indexOf("dmTest=true")?1:0},getUserSyncs:function(e,r,t,n){var i=[],o="https://cdn.districtm.io/ids/index.html";if(t&&t.gdprApplies&&"string"==typeof t.consentString&&i.push(["gdpr",t.consentString]),n&&i.push(["ccpa",n]),i.length>0&&(o+="?"+i.map((function(e){return e.join("=")})).join("&")),e.iframeEnabled)return[{type:"iframe",url:o}]}};function g(e){var r=null;if("function"==typeof e.getFloor){var t=e.getFloor({currency:"USD",mediaType:e.mediaTypes.video?"video":"banner",size:e.sizes.map((function(e){return{w:e[0],h:e[1]}}))});"object"!==p(t)||"USD"!==t.currency||isNaN(parseFloat(t.floor))||(r=parseFloat(t.floor))}return null!==r?r:e.params.floor}function v(e,r){var t=O(e,[{size:[300,250],s:100},{size:[728,90],s:95},{size:[320,50],s:90},{size:[160,600],s:88},{size:[300,600],s:85},{size:[300,50],s:80},{size:[970,250],s:75},{size:[970,90],s:60}]);switch(r){case"w":return t[0][0]||0;case"h":return t[0][1]||0;case"size":default:return t}}function O(e,r){var t=e.filter((function(e){return-1===r.map((function(e){return"".concat(e.size[0],"x").concat(e.size[1])})).indexOf("".concat(e[0],"x").concat(e[1]))})),n=e.reduce((function(e,t){return 0===e.length?(e.push(t),e):(e.push(t),(e=(e=r.filter((function(r){return-1!==e.map((function(e){return"".concat(e[0],"x").concat(e[1])})).indexOf("".concat(r.size[0],"x").concat(r.size[1]))}))).sort((function(e,r){return r.s-e.s}))).map((function(e){return e.size})))}),[]);return A([].concat(c(n),c(t)))}function A(e){return e.filter((function(r,t){return e.map((function(e){return"".concat(e[0],"x").concat(e[1])})).indexOf("".concat(r[0],"x").concat(r[1]))===t}))}function I(e,r,t,n){for(var i=[];0!==e.length;)e.length>=5?i.push(e.splice(0,5)):i.push(e.splice(0,e.length));return i.map((function(e){return r.imp=e,{method:"POST",url:n,data:JSON.stringify(r),bidderRequest:t}}))}function j(e,r){return a(r.bidderRequest.bids.filter((function(r){return r.bidId===e})),1)[0]}function S(e){return Array.isArray(e)&&Array.isArray(e[0])?e[0]:e}function x(e){var r=e.sizes,t={};return t.width=S(r)[0],t.height=S(r)[1],t}function w(e,r,t,i){Object(n.isStr)(r)&&Array.isArray(e)&&e.push({source:t,uids:[{id:r,atype:i}]})}function T(e){var r=e.api;return r&&Array.isArray(r)&&r.length>0?r:[2]}function z(e){var r=e.protocols;return r&&Array.isArray(r)&&r.length>0?r:[2,3,5,6,7,8]}function _(e,r){try{var t=/<img\s[^>]*?src\s*=\s*['\"]([^'\"]*?)['\"][^>]*?>/,n=a(e.match(t),2),i=n[0],o=n[1];if(e=e.replace(t,""),i&&o){var s="<Impression><![CDATA[".concat(o,"]]></Impression>");e=e.replace("</Impression>","</Impression>".concat(s))}return e}catch(t){if(!r)return e;var c="<Impression><![CDATA[".concat(r,"]]></Impression>");return e=e.replace("</Impression>","</Impression>".concat(c))}}Object(i.registerBidder)(h),window.pbjs.installedModules.push("districtmDMXBidAdapter")}},[304]);