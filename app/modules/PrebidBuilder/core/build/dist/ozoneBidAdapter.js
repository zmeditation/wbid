pbjsChunk([181],{585:function(e,t,r){e.exports=r(586)},586:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"spec",(function(){return f})),t.injectAdIdsIntoAllBidResponses=y,t.checkDeepArray=m,t.defaultSize=O,t.ozoneGetWinnerForRequestBid=I,t.ozoneGetAllBidsForBidId=v,t.getRoundedBid=j,t.getGranularityKeyName=w,t.getGranularityObject=A,t.ozoneAddStandardProperties=S,t.getWidthAndHeightFromVideoObject=B,t.playerSizeIsNestedArray=D;var i=r(0),o=r(1),n=r(2),a=r(3),s=r(29),d=r(13);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p="https://elb.the-ozone-project.com",u="/openrtb2/auction",g="/static/load-cookie.html",b="https://test.ozpr.net",h="2.7.0",f={gvlid:524,aliases:[{code:"lmc",gvlid:524},{code:"newspassid",gvlid:524}],version:h,code:"ozone",supportedMediaTypes:[n.d,n.b],cookieSyncBag:{publisherId:null,siteId:null,userIdObject:{}},propertyBag:{pageId:null,buildRequestsStart:0,buildRequestsEnd:0,endpointOverride:null},whitelabel_defaults:{logId:"OZONE",bidder:"ozone",keyPrefix:"oz",auctionUrl:p+u,cookieSyncUrl:p+g,rendererUrl:"https://prebid.the-ozone-project.com/ozone-renderer.js"},loadWhitelabelData:function(e){if(!this.propertyBag.whitelabel){this.propertyBag.whitelabel=JSON.parse(JSON.stringify(this.whitelabel_defaults));var t=e.bidder||"ozone";this.propertyBag.whitelabel.logId=t.toUpperCase(),this.propertyBag.whitelabel.bidder=t;var r=a.b.getConfig(t)||{};Object(i.logInfo)("got bidderConfig: ",JSON.parse(JSON.stringify(r))),r.kvpPrefix&&(this.propertyBag.whitelabel.keyPrefix=r.kvpPrefix);var o=this.getGetParametersAsObject();r.endpointOverride&&(r.endpointOverride.origin&&(this.propertyBag.endpointOverride=r.endpointOverride.origin,this.propertyBag.whitelabel.auctionUrl=r.endpointOverride.origin+u,this.propertyBag.whitelabel.cookieSyncUrl=r.endpointOverride.origin+g),o.hasOwnProperty("renderer")?o.renderer.match("%3A%2F%2F")?this.propertyBag.whitelabel.rendererUrl=decodeURIComponent(o.renderer):this.propertyBag.whitelabel.rendererUrl=o.renderer:r.endpointOverride.rendererUrl&&(this.propertyBag.whitelabel.rendererUrl=r.endpointOverride.rendererUrl),r.endpointOverride.cookieSyncUrl&&(this.propertyBag.whitelabel.cookieSyncUrl=r.endpointOverride.cookieSyncUrl),r.endpointOverride.auctionUrl&&(this.propertyBag.endpointOverride=r.endpointOverride.auctionUrl,this.propertyBag.whitelabel.auctionUrl=r.endpointOverride.auctionUrl));try{o.hasOwnProperty("auction")&&"dev"===o.auction&&(Object(i.logInfo)("GET: auction=dev"),this.propertyBag.whitelabel.auctionUrl=b+u),o.hasOwnProperty("cookiesync")&&"dev"===o.cookiesync&&(Object(i.logInfo)("GET: cookiesync=dev"),this.propertyBag.whitelabel.cookieSyncUrl=b+g)}catch(e){}Object(i.logInfo)("set propertyBag.whitelabel to",this.propertyBag.whitelabel)}},getAuctionUrl:function(){return this.propertyBag.whitelabel.auctionUrl},getCookieSyncUrl:function(){return this.propertyBag.whitelabel.cookieSyncUrl},getRendererUrl:function(){return this.propertyBag.whitelabel.rendererUrl},isBidRequestValid:function(e){this.loadWhitelabelData(e),Object(i.logInfo)("isBidRequestValid : ",a.b.getConfig(),e);var t=e.adUnitCode,r="VALIDATION FAILED : missing {param} : siteId, placementId and publisherId are REQUIRED";if(!e.params.hasOwnProperty("placementId"))return Object(i.logError)(r.replace("{param}","placementId"),t),!1;if(!this.isValidPlacementId(e.params.placementId))return Object(i.logError)("VALIDATION FAILED : placementId must be exactly 10 numeric characters",t),!1;if(!e.params.hasOwnProperty("publisherId"))return Object(i.logError)(r.replace("{param}","publisherId"),t),!1;if(!e.params.publisherId.toString().match(/^[a-zA-Z0-9\-]{12}$/))return Object(i.logError)("VALIDATION FAILED : publisherId must be exactly 12 alphanumieric characters including hyphens",t),!1;if(!e.params.hasOwnProperty("siteId"))return Object(i.logError)(r.replace("{param}","siteId"),t),!1;if(!e.params.siteId.toString().match(/^[0-9]{10}$/))return Object(i.logError)("VALIDATION FAILED : siteId must be exactly 10 numeric characters",t),!1;if(e.params.hasOwnProperty("customParams"))return Object(i.logError)("VALIDATION FAILED : customParams should be renamed to customData",t),!1;if(e.params.hasOwnProperty("customData")){if(!Array.isArray(e.params.customData))return Object(i.logError)("VALIDATION FAILED : customData is not an Array",t),!1;if(e.params.customData.length<1)return Object(i.logError)("VALIDATION FAILED : customData is an array but does not contain any elements",t),!1;if(!e.params.customData[0].hasOwnProperty("targeting"))return Object(i.logError)('VALIDATION FAILED : customData[0] does not contain "targeting"',t),!1;if("object"!=l(e.params.customData[0].targeting))return Object(i.logError)("VALIDATION FAILED : customData[0] targeting is not an object",t),!1}if(e.hasOwnProperty("mediaTypes")&&e.mediaTypes.hasOwnProperty(n.d)){if(!e.mediaTypes[n.d].hasOwnProperty("context"))return Object(i.logError)("No video context key/value in bid. Rejecting bid: ",e),!1;if("instream"!==e.mediaTypes[n.d].context&&"outstream"!==e.mediaTypes[n.d].context)return Object(i.logError)("video.context is invalid. Only instream/outstream video is supported. Rejecting bid: ",e),!1}return!0},isValidPlacementId:function(e){return e.toString().match(/^[0-9]{10}$/)},buildRequests:function(e,t){var r=this;this.loadWhitelabelData(e[0]),this.propertyBag.buildRequestsStart=(new Date).getTime();var o=this.propertyBag.whitelabel.bidder,s=this.propertyBag.whitelabel.keyPrefix;if(Object(i.logInfo)("buildRequests time: ".concat(this.propertyBag.buildRequestsStart," v ").concat(h," validBidRequests"),JSON.parse(JSON.stringify(e)),"bidderRequest",JSON.parse(JSON.stringify(t))),this.blockTheRequest())return[];var d={publisherId:"",siteId:""};e.length>0&&(this.cookieSyncBag.userIdObject=c(this.cookieSyncBag.userIdObject,this.findAllUserIds(e[0])),this.cookieSyncBag.siteId=Object(i.deepAccess)(e[0],"params.siteId"),this.cookieSyncBag.publisherId=Object(i.deepAccess)(e[0],"params.publisherId"),d=e[0].params),Object(i.logInfo)("cookie sync bag",this.cookieSyncBag);var p=this.getWhitelabelConfigItem("ozone.singleRequest");p=!1!==p,Object(i.logInfo)("config ".concat(o,".singleRequest : "),p);var u={};delete u.test;var g=a.b.getConfig("ortb2");g&&Object(i.deepAccess)(g,"user")&&(Object(i.logInfo)("added FPD user object"),u.user=g.user);var b=this.getGetParametersAsObject(),f=s+"testmode",y=b[f]||null;u.device={w:window.innerWidth,h:window.innerHeight};var m=this.getPlacementIdOverrideFromGetParam(),O=null,I=e.map((function(e){var t={},a=m||r.getPlacementId(e);t.id=e.bidId,t.tagid=a,t.secure="https:"===window.location.protocol?1:0;var s=[];if(e.hasOwnProperty("mediaTypes")){if(e.mediaTypes.hasOwnProperty(n.b)&&(s=e.mediaTypes[n.b].sizes,Object(i.logInfo)("setting banner size from the mediaTypes.banner element for bidId "+t.id+": ",s)),e.mediaTypes.hasOwnProperty(n.d)){if(Object(i.logInfo)("openrtb 2.5 compliant video"),"object"==l(e.mediaTypes[n.d])){var d=Object(i.deepAccess)(e,"params.video",{});t.video=r.unpackVideoConfigIntoIABformat(e.mediaTypes[n.d],d),t.video=r.addVideoDefaults(t.video,e.mediaTypes[n.d],d)}var p=B(t.video);Object(i.logInfo)("setting video object from the mediaTypes.video element: "+t.id+":",t.video,"wh=",p),p&&"object"===l(p)?(t.video.w=p.w,t.video.h=p.h,D(t.video)?(Object(i.logInfo)("setting obj.video.format to be an array of objects"),t.video.ext.format=[p]):(Object(i.logInfo)("setting obj.video.format to be an object"),t.video.ext.format=p)):Object(i.logWarn)("cannot set w, h & format values for video; the config is not right")}e.mediaTypes.hasOwnProperty(n.c)&&(t.native=e.mediaTypes[n.c],Object(i.logInfo)("setting native object from the mediaTypes.native element: "+t.id+":",t.native)),e.hasOwnProperty("getFloor")?(Object(i.logInfo)("This bidRequest object has property: getFloor"),t.floor=r.getFloorObjectForAuction(e),Object(i.logInfo)("obj.floor is : ",t.floor)):Object(i.logInfo)("This bidRequest object DOES NOT have property: getFloor")}else e.hasOwnProperty("sizes")?(Object(i.logInfo)("no mediaTypes detected - will use the sizes array in the config root"),s=e.sizes):Object(i.logInfo)("no mediaTypes detected, no sizes array in the config root either. Cannot set sizes for banner type");if(s.length>0&&(t.banner={topframe:1,w:s[0][0]||0,h:s[0][1]||0,format:s.map((function(e){return{w:e[0],h:e[1]}}))}),t.placementId=a,Object(i.deepSetValue)(t,"ext.prebid",{storedrequest:{id:a}}),t.ext[o]={},t.ext[o].adUnitCode=e.adUnitCode,t.ext[o].transactionId=e.transactionId,e.params.hasOwnProperty("customData")&&(t.ext[o].customData=e.params.customData),Object(i.logInfo)("obj.ext.".concat(o," is "),t.ext[o]),null!=y)if(Object(i.logInfo)("setting isTestMode to ",y),t.ext[o].hasOwnProperty("customData"))for(var u=0;u<t.ext[o].customData.length;u++)t.ext[o].customData[u].targeting[f]=y;else t.ext[o].customData=[{settings:{},targeting:{}}],t.ext[o].customData[0].targeting[f]=y;return g&&Object(i.deepAccess)(g,"site")&&(Object(i.logInfo)("added fpd.site"),Object(i.deepAccess)(t,"ext."+o+".customData.0.targeting",!1)?t.ext[o].customData[0].targeting=c(t.ext[o].customData[0].targeting,g.site):Object(i.deepSetValue)(t,"ext."+o+".customData.0.targeting",g.site)),!O&&Object(i.deepAccess)(e,"schain")&&(O=e.schain),t})),v={};if(v[o]={},v[o][s+"_pb_v"]=h,v[o][s+"_rw"]=m?1:0,e.length>0){var j=this.cookieSyncBag.userIdObject;j.hasOwnProperty("pubcid")&&(v[o].pubcid=j.pubcid)}v[o].pv=this.getPageId();var w=this.getWhitelabelConfigItem("ozone.oz_omp_floor");Object(i.logInfo)("".concat(s,"_omp_floor dollar value = "),w),"number"==typeof w?v[o][s+"_omp_floor"]=w:void 0!==w&&Object(i.logError)("".concat(s,"_omp_floor is invalid - IF SET then this must be a number, representing dollar value eg. ").concat(s,"_omp_floor: 1.55. You have it set as a ")+l(w));var A=this.getWhitelabelConfigItem("ozone.oz_whitelist_adserver_keys"),S=Object(i.isArray)(A)&&A.length>0;v[o][s+"_kvp_rw"]=S?1:0,"ozone"!=o&&(Object(i.logInfo)("setting aliases object"),v.prebid={aliases:{ozone:o}}),b.hasOwnProperty("ozf")&&(v[o].ozf="true"==b.ozf||1==b.ozf?1:0),b.hasOwnProperty("ozpf")&&(v[o].ozpf="true"==b.ozpf||1==b.ozpf?1:0),b.hasOwnProperty("ozrp")&&b.ozrp.match(/^[0-3]$/)&&(v[o].ozrp=parseInt(b.ozrp)),b.hasOwnProperty("ozip")&&b.ozip.match(/^\d+$/)&&(v[o].ozip=parseInt(b.ozip)),null!=this.propertyBag.endpointOverride&&(v[o].origin=this.propertyBag.endpointOverride);var P=this.generateEids(e);if(u.site={publisher:{id:d.publisherId},page:document.location.href,id:d.siteId},u.test=b.hasOwnProperty("pbjs_debug")&&"true"===b.pbjs_debug?1:0,t&&t.gdprConsent){Object(i.logInfo)("ADDING GDPR info");var T=Object(i.deepAccess)(t,"gdprConsent.apiVersion",1);u.regs={ext:{gdpr:t.gdprConsent.gdprApplies?1:0,apiVersion:T}},Object(i.deepAccess)(u,"regs.ext.gdpr")?Object(i.deepSetValue)(u,"user.ext.consent",t.gdprConsent.consentString):Object(i.logInfo)("**** Strange CMP info: bidderRequest.gdprConsent exists BUT bidderRequest.gdprConsent.gdprApplies is false. See bidderRequest logged above. ****")}else Object(i.logInfo)("WILL NOT ADD GDPR info; no bidderRequest.gdprConsent object");if(t&&t.uspConsent?(Object(i.logInfo)("ADDING CCPA info"),Object(i.deepSetValue)(u,"user.ext.uspConsent",t.uspConsent)):Object(i.logInfo)("WILL NOT ADD CCPA info; no bidderRequest.uspConsent."),O&&(Object(i.logInfo)("schain found"),Object(i.deepSetValue)(u,"source.ext.schain",O)),!0===a.b.getConfig("coppa")&&Object(i.deepSetValue)(u,"regs.coppa",1),p){Object(i.logInfo)("buildRequests starting to generate response for a single request"),u.id=t.auctionId,u.auctionId=t.auctionId,u.imp=I,u.ext=v,Object(i.deepSetValue)(u,"source.tid",t.auctionId),Object(i.deepSetValue)(u,"user.ext.eids",P);var k={method:"POST",url:this.getAuctionUrl(),data:JSON.stringify(u),bidderRequest:t};return Object(i.logInfo)("buildRequests request data for single = ",JSON.parse(JSON.stringify(u))),this.propertyBag.buildRequestsEnd=(new Date).getTime(),Object(i.logInfo)("buildRequests going to return for single at time ".concat(this.propertyBag.buildRequestsEnd," (took ").concat(this.propertyBag.buildRequestsEnd-this.propertyBag.buildRequestsStart,"ms): "),k),k}var R=I.map((function(e){Object(i.logInfo)("buildRequests starting to generate non-single response, working on imp : ",e);var n=c({},u);return e.ext[o].pageAuctionId=t.auctionId,n.id=e.ext[o].transactionId,n.auctionId=e.ext[o].transactionId,n.imp=[e],n.ext=v,Object(i.deepSetValue)(n,"source.tid",e.ext[o].transactionId),Object(i.deepSetValue)(n,"user.ext.eids",P),Object(i.logInfo)("buildRequests RequestSingle (for non-single) = ",n),{method:"POST",url:r.getAuctionUrl(),data:JSON.stringify(n),bidderRequest:t}}));return this.propertyBag.buildRequestsEnd=(new Date).getTime(),Object(i.logInfo)("buildRequests going to return for non-single at time ".concat(this.propertyBag.buildRequestsEnd," (took ").concat(this.propertyBag.buildRequestsEnd-this.propertyBag.buildRequestsStart,"ms): "),R),R},getFloorObjectForAuction:function(e){var t={banner:Object(i.deepAccess)(e,"mediaTypes.banner.sizes",null),video:Object(i.deepAccess)(e,"mediaTypes.video.playerSize",null),native:Object(i.deepAccess)(e,"mediaTypes.native.image.sizes",null)};Object(i.logInfo)("getFloorObjectForAuction mediaTypesSizes : ",t);var r={};return t.banner&&(r.banner=e.getFloor({mediaType:"banner",currency:"USD",size:t.banner})),t.video&&(r.video=e.getFloor({mediaType:"video",currency:"USD",size:t.video})),t.native&&(r.native=e.getFloor({mediaType:"native",currency:"USD",size:t.native})),Object(i.logInfo)("getFloorObjectForAuction returning : ",JSON.parse(JSON.stringify(r))),r},interpretResponse:function(e,t){var r=this;t&&t.bidderRequest&&t.bidderRequest.bids&&this.loadWhitelabelData(t.bidderRequest.bids[0]);var o=(new Date).getTime(),a=this.propertyBag.whitelabel.bidder,s=this.propertyBag.whitelabel.keyPrefix;if(Object(i.logInfo)("interpretResponse time: ".concat(o," . Time between buildRequests done and interpretResponse start was ").concat(o-this.propertyBag.buildRequestsEnd,"ms")),Object(i.logInfo)("serverResponse, request",JSON.parse(JSON.stringify(e)),JSON.parse(JSON.stringify(t))),!(e=e.body||{}).hasOwnProperty("seatbid"))return[];if("object"!==l(e.seatbid))return[];var d=[],c=this.getWhitelabelConfigItem("ozone.enhancedAdserverTargeting");Object(i.logInfo)("enhancedAdserverTargeting",c),void 0===c&&(c=!0),Object(i.logInfo)("enhancedAdserverTargeting",c),e.seatbid=y(e.seatbid),e.seatbid=this.removeSingleBidderMultipleBids(e.seatbid);for(var p=this.getWhitelabelConfigItem("ozone.oz_omp_floor"),u="number"==typeof p,g=this.getWhitelabelConfigItem("ozone.oz_whitelist_adserver_keys"),b=Object(i.isArray)(g)&&g.length>0,f=0;f<e.seatbid.length;f++)for(var m=e.seatbid[f],w=function(o){var l=r.getBidRequestForBidId(m.bid[o].impid,t.bidderRequest.bids);Object(i.logInfo)("seatbid:".concat(f,", bid:").concat(o," Going to set default w h for seatbid/bidRequest"),m.bid[o],l);var y=O(l),w=y.defaultWidth,A=y.defaultHeight,B=S(m.bid[o],w,A);B.meta={advertiserDomains:B.adomain||[]};var D=null,P=!1,k=Object(i.deepAccess)(B,"ext.prebid.type");Object(i.logInfo)("this bid type is : ".concat(k),o),k===n.d&&(P=!0,"outstream"===(D=r.getVideoContextForBidId(B.bidId,t.bidderRequest.bids))?(Object(i.logInfo)("going to attach a renderer to OUTSTREAM video : ",o),B.renderer=T(B.bidId)):Object(i.logInfo)("bid is not an outstream video, will not attach a renderer: ",o));var R={};if(c){var x=v(B.bidId,e.seatbid);Object(i.logInfo)("Going to iterate allBidsForThisBidId",x),Object.keys(x).forEach((function(e,t,r){Object(i.logInfo)("adding adserverTargeting for ".concat(e," for bidId ").concat(B.bidId)),R[s+"_"+e]=e,R[s+"_"+e+"_crid"]=String(x[e].crid),R[s+"_"+e+"_adv"]=String(x[e].adomain),R[s+"_"+e+"_adId"]=String(x[e].adId),R[s+"_"+e+"_pb_r"]=j(x[e].price,x[e].ext.prebid.type),x[e].hasOwnProperty("dealid")&&(R[s+"_"+e+"_dealid"]=String(x[e].dealid)),u&&(R[s+"_"+e+"_omp"]=x[e].price>=p?"1":"0"),P&&(R[s+"_"+e+"_vid"]=D);var o=Object(i.deepAccess)(x[e],"ext.bidder.".concat(a,".floor"),null);null!=o&&(R[s+"_"+e+"_flr"]=o);var n=Object(i.deepAccess)(x[e],"ext.bidder.".concat(a,".ruleId"),null);null!=n&&(R[s+"_"+e+"_rid"]=n),e.match(/^ozappnexus/)&&(R[s+"_"+e+"_sid"]=String(x[e].cid))}))}else b?Object(i.logWarn)("You have set a whitelist of adserver keys but this will be ignored because ".concat(a,".enhancedAdserverTargeting is set to false. No per-bid keys will be sent to adserver.")):Object(i.logInfo)("".concat(a,".enhancedAdserverTargeting is set to false, so no per-bid keys will be sent to adserver."));var z=I(B.bidId,e.seatbid),_=z.seat,q=z.bid;R[s+"_auc_id"]=String(t.bidderRequest.auctionId),R[s+"_winner"]=String(_),R[s+"_bid"]="true",c&&(R[s+"_imp_id"]=String(q.impid),R[s+"_pb_v"]=h,R[s+"_pb"]=q.price,R[s+"_pb_r"]=j(q.price,k),R[s+"_adId"]=String(q.adId),R[s+"_size"]="".concat(q.width,"x").concat(q.height)),b&&(Object(i.logInfo)("Going to filter out adserver targeting keys not in the whitelist: ",g),Object.keys(R).forEach((function(e){-1===g.indexOf(e)&&delete R[e]}))),B.adserverTargeting=R,d.push(B)},A=0;A<m.bid.length;A++)w(A);var B=(new Date).getTime();return Object(i.logInfo)("interpretResponse going to return at time ".concat(B," (took ").concat(B-o,"ms) Time from buildRequests Start -> interpretRequests End = ").concat(B-this.propertyBag.buildRequestsStart,"ms"),d),d},getWhitelabelConfigItem:function(e){if("ozone"==this.propertyBag.whitelabel.bidder)return a.b.getConfig(e);var t=e.replace("ozone",this.propertyBag.whitelabel.bidder);return t=t.replace("oz_",this.propertyBag.whitelabel.keyPrefix+"_"),a.b.getConfig(t)},removeSingleBidderMultipleBids:function(e){for(var t=[],r=0;r<e.length;r++){for(var o=e[r],n={seat:o.seat,bid:[]},a=[],s=0;s<o.bid.length;s++){var d=o.bid[s];if(!Object(i.contains)(a,d.impid)){a.push(d.impid);for(var c=s+1;c<o.bid.length;c++)o.bid[c].impid===d.impid&&o.bid[c].price>d.price&&(d=o.bid[c]);n.bid.push(d)}}t.push(n)}return t},getUserSyncs:function(e,t,r,o){if(Object(i.logInfo)("getUserSyncs optionsType",e,"serverResponse",t,"gdprConsent",r,"usPrivacy",o,"cookieSyncBag",this.cookieSyncBag),!t||0===t.length)return[];if(e.iframeEnabled){var n=[];for(var a in document.location.search.match(/pbjs_debug=true/)&&n.push("pbjs_debug=true"),n.push("gdpr="+(Object(i.deepAccess)(r,"gdprApplies",!1)?"1":"0")),n.push("gdpr_consent="+Object(i.deepAccess)(r,"consentString","")),n.push("usp_consent="+(o||"")),this.cookieSyncBag.userIdObject)n.push(a+"="+this.cookieSyncBag.userIdObject[a]);n.push("publisherId="+this.cookieSyncBag.publisherId),n.push("siteId="+this.cookieSyncBag.siteId),n.push("cb="+Date.now()),n.push("bidder="+this.propertyBag.whitelabel.bidder);var s=n.join("&");return s.length>0&&(s="?"+s),Object(i.logInfo)("getUserSyncs going to return cookie sync url : "+this.getCookieSyncUrl()+s),[{type:"iframe",url:this.getCookieSyncUrl()+s}]}},getBidRequestForBidId:function(e,t){for(var r=0;r<t.length;r++)if(t[r].bidId===e)return t[r];return null},getVideoContextForBidId:function(e,t){var r=this.getBidRequestForBidId(e,t);return null!=r?Object(i.deepAccess)(r,"mediaTypes.video.context","unknown"):null},findAllUserIds:function(e){var t={},r=["pubcid","tdid","idl_env","criteoId","lotamePanoramaId","fabrickId"];if(e.hasOwnProperty("userId")){for(var o in r){var n=r[o];e.userId.hasOwnProperty(n)&&("string"==typeof e.userId[n]?t[n]=e.userId[n]:"object"==l(e.userId[n])?(Object(i.logError)("WARNING: findAllUserIds had to use first key in user object to get value for bid.userId key: ".concat(n,". Prebid adapter should be updated.")),t[n]=e.userId[n][Object.keys(e.userId[n])[0]]):Object(i.logError)("failed to get string key value for userId : ".concat(n)))}var a=Object(i.deepAccess)(e.userId,"lipb.lipbid");a&&(t.lipb={lipbid:a});var s=Object(i.deepAccess)(e.userId,"id5id.uid");s&&(t.id5id=s);var d=Object(i.deepAccess)(e.userId,"parrableId.eid");d&&(t.parrableId=d);var c=Object(i.deepAccess)(e.userId,"sharedid.id");c&&(t.sharedid=c);var p=Object(i.deepAccess)(e.userId,"sharedid.third");p&&(t.sharedidthird=p)}if(!t.hasOwnProperty("pubcid")){var u=Object(i.deepAccess)(e,"crumbs.pubcid");u&&(t.pubcid=u)}return t},getPlacementId:function(e){return e.params.placementId.toString()},getPlacementIdOverrideFromGetParam:function(){var e=this.propertyBag.whitelabel.keyPrefix,t=this.getGetParametersAsObject();if(t.hasOwnProperty(e+"storedrequest")){if(this.isValidPlacementId(t[e+"storedrequest"]))return Object(i.logInfo)("using GET ".concat(e,"storedrequest ")+t[e+"storedrequest"]+" to replace placementId"),t[e+"storedrequest"];Object(i.logError)("GET ".concat(e,"storedrequest FAILED VALIDATION - will not use it"))}return null},generateEids:function(e){var t,r=e[0];return r&&r.userId&&(t=r.userIdAsEids,this.handleTTDId(t,e)),t},handleTTDId:function(e,t){var r=null,o=a.b.getConfig("adsrvrOrgId");Object(i.isStr)(Object(i.deepAccess)(t,"0.userId.tdid"))?r=t[0].userId.tdid:o&&Object(i.isStr)(o.TDID)&&(r=o.TDID),null!==r&&e.push({source:"adserver.org",uids:[{id:r,atype:1,ext:{rtiPartner:"TDID"}}]})},getGetParametersAsObject:function(){for(var e=location.search.substr(1).split("&"),t={},r=null,i=0;i<e.length;i++)t[(r=e[i].split("="))[0]]=r[1];return t},blockTheRequest:function(){var e=this.getWhitelabelConfigItem("ozone.oz_request");return"boolean"==typeof e&&!e&&(Object(i.logWarn)("Will not allow auction : ".concat(this.propertyBag.whitelabel.keyPrefix,"one.").concat(this.propertyBag.whitelabel.keyPrefix,"_request is set to false")),!0)},getPageId:function(){if(null==this.propertyBag.pageId){for(var e="",t=20;t>0;t--)e+="0123456789abcdefghijklmnopqrstuvwxyz"[Math.floor(36*Math.random())];this.propertyBag.pageId=(new Date).getTime()+"_"+e}return this.propertyBag.pageId},unpackVideoConfigIntoIABformat:function(e,t){var r={ext:{}};return r=this._unpackVideoConfigIntoIABformat(r,e),r=this._unpackVideoConfigIntoIABformat(r,t)},_unpackVideoConfigIntoIABformat:function(e,t){var r=["mimes","minduration","maxduration","protocols","w","h","startdelay","placement","linearity","skip","skipmin","skipafter","sequence","battr","maxextended","minbitrate","maxbitrate","boxingallowed","playbackmethod","playbackend","delivery","pos","companionad","api","companiontype"],o=function(i){a=!1,r.forEach((function(r){r===i&&(e[i]=t[i],a=!0)})),a||(e.ext[i]=t[i])};for(var n in t){var a;o(n)}return t.hasOwnProperty("ext")&&"object"===l(t.ext)&&(t.hasOwnProperty("ext")?e.ext=Object(i.mergeDeep)(e.ext,t.ext):e.ext=t.ext),e},addVideoDefaults:function(e,t,r){return e=this._addVideoDefaults(e,t,!1),e=this._addVideoDefaults(e,r,!0)},_addVideoDefaults:function(e,t,r){var o=Object(i.deepAccess)(t,"context");"outstream"===o?e.placement=3:"instream"===o&&(e.placement=1);var n=Object(i.deepAccess)(t,"skippable",null);return null==n?r&&!e.hasOwnProperty("skip")&&(e.skip=n?1:0):e.skip=n?1:0,e}};function y(e){Object(i.logInfo)("injectAdIdsIntoAllBidResponses",e);for(var t=0;t<e.length;t++)for(var r=e[t],o=0;o<r.bid.length;o++)r.bid[o].adId="".concat(r.bid[o].impid,"-").concat(t,"-").concat(f.propertyBag.whitelabel.keyPrefix,"-").concat(o);return e}function m(e){return Array.isArray(e)&&Array.isArray(e[0])?e[0]:e}function O(e){if(!e)return Object(i.logInfo)("defaultSize received empty bid obj! going to return fixed default size"),{defaultHeight:250,defaultWidth:300};var t=e.sizes,r={};return r.defaultWidth=m(t)[0],r.defaultHeight=m(t)[1],r}function I(e,t){for(var r=null,i=null,o=0;o<t.length;o++)for(var n=t[o].bid,a=t[o].seat,s=0;s<n.length;s++)if(n[s].impid===e&&(null==r||r.price<n[s].price)){r=n[s],i=a;break}return{seat:i,bid:r}}function v(e,t){for(var r={},i=0;i<t.length;i++)for(var o=t[i].bid,n=t[i].seat,a=0;a<o.length;a++)o[a].impid===e&&(r.hasOwnProperty(n)?r[n].price<o[a].price&&(r[n]=o[a]):r[n]=o[a]);return r}function j(e,t){var r=a.b.getConfig("mediaTypePriceGranularity.".concat(t)),o=a.b.getConfig("customPriceBucket"),n=a.b.getConfig("priceGranularity"),d=A(t,r,n,o),c=w(t,r,n);Object(i.logInfo)("getRoundedBid. price:",e,"mediaType:",t,"configkey:",c,"configObject:",d,"mediaTypeGranularity:",r,"strBuckets:",n);var l=Object(s.a)(e,d,a.b.getConfig("currency.granularityMultiplier"));Object(i.logInfo)("priceStringsObj",l);var p={medium:"med",custom:"custom",high:"high",low:"low",dense:"dense"};if(p.hasOwnProperty(c)){var u=p[c];return Object(i.logInfo)("getRoundedBid: looking for priceStringsKey:",u),l[u]}return l.auto}function w(e,t,r){return"string"==typeof t?t:"object"===l(t)?"custom":"string"==typeof r?r:"auto"}function A(e,t,r,i){return"object"===l(t)?t:"custom"===r?i:""}function S(e,t,r){return e.cpm=e.price,e.bidId=e.impid,e.requestId=e.impid,e.width=e.w||t,e.height=e.h||r,e.ad=e.adm,e.netRevenue=!0,e.creativeId=e.crid,e.currency="USD",e.ttl=300,e}function B(e){var t=P(e);return t?t[0]&&"object"===l(t[0])&&(Object(i.logInfo)("getWidthAndHeightFromVideoObject found nested array inside playerSize.",t[0]),"number"!=typeof(t=t[0])[0]&&"string"!=typeof t[0])?(Object(i.logInfo)("getWidthAndHeightFromVideoObject found non-number/string type inside the INNER array in playerSize. This is totally wrong - cannot continue.",t[0]),null):2!==t.length?(Object(i.logInfo)("getWidthAndHeightFromVideoObject found playerSize with length of "+t.length+". This is totally wrong - cannot continue."),null):{w:t[0],h:t[1]}:null}function D(e){var t=P(e);return t?t.length<1?null:t[0]&&"object"===l(t[0]):null}function P(e){Object(i.logInfo)("getPlayerSizeFromObject received object",e);var t=Object(i.deepAccess)(e,"playerSize");return t||(t=Object(i.deepAccess)(e,"ext.playerSize")),t?"object"!==l(t)?(Object(i.logError)("getPlayerSizeFromObject FAILED: playerSize is not an object/array",e),null):t:(Object(i.logError)("getPlayerSizeFromObject FAILED: no playerSize in video object or ext",e),null)}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=window.ozoneVideo;Object(i.logInfo)("newRenderer going to set loaded to ".concat(r?"true":"false"));var o=d.a.install({url:f.getRendererUrl(),config:t,loaded:r,adUnitCode:e});try{o.setRender(k)}catch(e){Object(i.logError)("Prebid Error when calling setRender on renderer",JSON.parse(JSON.stringify(o)),e)}return o}function k(e){Object(i.logInfo)("outstreamRender called. Going to push the call to window.ozoneVideo.outstreamRender(bid) bid =",JSON.parse(JSON.stringify(e))),e.renderer.push((function(){window.ozoneVideo.outstreamRender(e)}))}Object(o.registerBidder)(f),Object(i.logInfo)("*BidAdapter ".concat(h," was loaded")),window.pbjs.installedModules.push("ozoneBidAdapter")}},[585]);