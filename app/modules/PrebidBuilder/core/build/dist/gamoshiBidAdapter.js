pbjsChunk([278],{348:function(e,r,t){e.exports=t(349)},349:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),t.d(r,"helper",(function(){return l})),t.d(r,"spec",(function(){return m}));var i=t(0),n=t(1),a=t(3),o=t(13),d=t(2),s=t(12),p=t.n(s);function c(){return(c=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}var u="https://rtb.gamoshi.io",l={getTopFrame:function(){try{return window.top===window?1:0}catch(e){}return 0},startsWith:function(e,r){return e.substr(0,r.length)===r},getTopWindowDomain:function(e){var r=e.indexOf("://")+"://".length;return e.substring(r,e.indexOf("/",r)<0?e.length:e.indexOf("/",r))},getMediaType:function(e){return e.ext?e.ext.media_type?e.ext.media_type.toLowerCase():e.ext.vast_url?d.d:d.b:d.b},getBidFloor:function(e){if(!Object(i.isFn)(e.getFloor))return e.params.bidfloor?e.params.bidfloor:null;var r=e.getFloor({mediaType:"*",size:"*",currency:"USD"});return Object(i.isPlainObject)(r)&&!isNaN(r.floor)&&"USD"===r.currency?r.floor:null}},m={code:"gamoshi",aliases:["gambid","9MediaOnline"],supportedMediaTypes:["banner","video"],isBidRequestValid:function(e){return!!e.params.supplyPartnerId&&Object(i.isStr)(e.params.supplyPartnerId)&&(!e.params.rtbEndpoint||Object(i.isStr)(e.params.rtbEndpoint))&&(!e.params.bidfloor||Object(i.isNumber)(e.params.bidfloor))&&(!e.params.adpos||Object(i.isNumber)(e.params.adpos))&&(!e.params.protocols||Array.isArray(e.params.protocols))&&(!e.params.instl||0===e.params.instl||1===e.params.instl)},buildRequests:function(e,r){var t=this;return e.map((function(n){var o=n.adUnitCode,s=n.auctionId,m=n.mediaTypes,b=n.params,f=n.sizes,y=n.transactionId,g=b.rtbEndpoint||u,h="".concat(g,"/r/").concat(b.supplyPartnerId,"/bidr?rformat=open_rtb&reqformat=rtb_json&bidder=prebid")+(b.query?"&"+b.query:""),x=a.b.getConfig("pageUrl")||r.refererInfo.referer,O={id:s,site:{domain:l.getTopWindowDomain(x),page:x,ref:r.refererInfo.referer},device:{ua:navigator.userAgent,dnt:Object(i.getDNT)()?1:0,h:screen.height,w:screen.width,language:navigator.language},imp:[],ext:{},user:{ext:{}},source:{ext:{}},regs:{ext:{}}},T=r.gdprConsent;T&&T.consentString&&T.gdprApplies&&(O.ext.gdpr_consent={consent_string:T.consentString,consent_required:T.gdprApplies},Object(i.deepSetValue)(O,"regs.ext.gdpr",!0===T.gdprApplies?1:0),Object(i.deepSetValue)(O,"user.ext.consent",T.consentString)),e[0].schain&&Object(i.deepSetValue)(O,"source.ext.schain",e[0].schain),r&&r.uspConsent&&Object(i.deepSetValue)(O,"regs.ext.us_privacy",r.uspConsent);var j={id:y,instl:1===b.instl?1:0,tagid:o,bidfloor:l.getBidFloor(n)||0,bidfloorcur:"USD",secure:1},w=b.favoredMediaType&&p()(t.supportedMediaTypes,b.favoredMediaType);if((!m||m.banner)&&(!w||b.favoredMediaType===d.b)){var A=c({},j,{banner:{w:f.length?f[0][0]:300,h:f.length?f[0][1]:250,pos:b.pos||0,topframe:Object(i.inIframe)()?0:1}});O.imp.push(A)}if(m&&m.video&&(!w||b.favoredMediaType===d.d)){var I=m.video.playerSize||f,S=c({},j,{video:{protocols:n.mediaTypes.video.protocols||b.protocols||[1,2,3,4,5,6],pos:b.pos||0,ext:{context:m.video.context},mimes:n.mediaTypes.video.mimes,maxduration:n.mediaTypes.video.maxduration,api:n.mediaTypes.video.api,skip:n.mediaTypes.video.skip||n.params.video.skip,placement:n.mediaTypes.video.placement||n.params.video.placement,minduration:n.mediaTypes.video.minduration||n.params.video.minduration,playbackmethod:n.mediaTypes.video.playbackmethod||n.params.video.playbackmethod,startdelay:n.mediaTypes.video.startdelay||n.params.video.startdelay}});Object(i.isArray)(I[0])?(S.video.w=I[0][0],S.video.h=I[0][1]):Object(i.isNumber)(I[0])?(S.video.w=I[0],S.video.h=I[1]):(S.video.w=300,S.video.h=250),O.imp.push(S)}var C=[];if(n&&n.userId&&(v(C,Object(i.deepAccess)(n,"userId.id5id.uid"),"id5-sync.com","ID5ID"),v(C,Object(i.deepAccess)(n,"userId.tdid"),"adserver.org","TDID")),C.length>0&&(O.user.ext.eids=C),0!==O.imp.length)return{method:"POST",url:h,data:O,bidRequest:n}}))},interpretResponse:function(e,r){var t=e&&e.body;if(!t)return Object(i.logError)("empty response"),[];var n=t.seatbid.reduce((function(e,r){return e.concat(r.bid)}),[]),a=[];return n.forEach((function(e){var n={requestId:r.bidRequest.bidId,cpm:e.price,width:e.w,height:e.h,ttl:360,creativeId:e.crid||e.adid,netRevenue:!0,currency:e.cur||t.cur,mediaType:l.getMediaType(e)};if(e.adomain&&e.adomain.length&&(n.meta={advertiserDomains:e.adomain}),Object(i.deepAccess)(r.bidRequest,"mediaTypes."+n.mediaType))if(n.mediaType===d.b)a.push(c({},n,{ad:e.adm}));else if(n.mediaType===d.d){var o=Object(i.deepAccess)(r.bidRequest,"mediaTypes.video.context");a.push(c({},n,{vastUrl:e.ext.vast_url,vastXml:e.adm,renderer:"outstream"===o?b(r.bidRequest,e):void 0}))}})),a},getUserSyncs:function(e,r,t,i){var n=[],a=!1,o="",d="";t&&"boolean"==typeof t.gdprApplies&&(a=t.gdprApplies);var s=a?1:0;a&&t.consentString&&(o=encodeURIComponent(t.consentString)),i&&(d=encodeURIComponent(i));var p={gdpr:s,consent:o,uspConsent:d};return r.forEach((function(e){if(e.body){var r=e.body;r.ext&&Array.isArray(r.ext.utrk)&&r.ext.utrk.forEach((function(e){var r=y(e.url,p);n.push({type:e.type,url:r})})),Array.isArray(r.seatbid)&&r.seatbid.forEach((function(e){Array.isArray(e.bid)&&e.bid.forEach((function(e){e.ext&&Array.isArray(e.ext.utrk)&&e.ext.utrk.forEach((function(e){var r=y(e.url,p);n.push({type:e.type,url:r})}))}))}))}})),n}};function b(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.a.install({url:e.params&&e.params.rendererUrl||r.ext&&r.ext.renderer_url||"https://s.gamoshi.io/video/latest/renderer.js",config:t,loaded:!1});try{n.setRender(f)}catch(e){Object(i.logWarn)("Prebid Error calling setRender on renderer",e)}return n}function f(e){e.renderer.push((function(){var r=e.adUnitCode+"/"+e.adId;window.GamoshiPlayer.renderAd({id:r,debug:window.location.href.indexOf("pbjsDebug")>=0,placement:document.getElementById(e.adUnitCode),width:e.width,height:e.height,events:{ALL_ADS_COMPLETED:function(){return window.setTimeout((function(){window.GamoshiPlayer.removeAd(r)}),300)}},vastUrl:e.vastUrl,vastXml:e.vastXml})}))}function v(e,r,t,n){Object(i.isStr)(r)&&e.push({source:t,uids:[{id:r,ext:{rtiPartner:n}}]})}function y(e,r){return e.replace("[GDPR]",r.gdpr).replace("[CONSENT]",r.consent).replace("[US_PRIVACY]",r.uspConsent)}Object(n.registerBidder)(m),window.pbjs.installedModules.push("gamoshiBidAdapter")}},[348]);