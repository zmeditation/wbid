pbjsChunk([277],{350:function(e,r,t){e.exports=t(351)},351:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),t.d(r,"purpose1Rule",(function(){return A})),t.d(r,"purpose2Rule",(function(){return C})),t.d(r,"purpose7Rule",(function(){return D})),t.d(r,"enforcementRules",(function(){return E})),t.d(r,"internal",(function(){return V})),r.getGvlid=H,r.validateRules=R,r.deviceAccessHook=T,r.userSyncHook=G,r.userIdHook=M,r.makeBidRequestsHook=W,r.enableAnalyticsHook=I,r.setEnforcementConfig=_;var n=t(0),o=t(3),a=t(9),c=t(11),i=t.n(c),s=t(12),l=t.n(s),u=t(1),p=t(8),d=t(7),f=t(10),b=t.n(f),g=t(5),v=t.n(g);function y(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function O(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?y(Object(t),!0).forEach((function(r){m(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function m(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function h(){return(h=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var A,C,D,E,P={purpose1:{id:1,name:"storage"},purpose2:{id:2,name:"basicAds"},purpose7:{id:7,name:"measurement"}},k=[{purpose:"storage",enforcePurpose:!0,enforceVendor:!0,vendorExceptions:[]},{purpose:"basicAds",enforcePurpose:!0,enforceVendor:!0,vendorExceptions:[]}],w=[],S=[],F=[],B=!1,V={getGvlidForBidAdapter:function(e){var r=null;if(e=e||o.b.getCurrentBidder()){var t=a.default.getBidAdapter(e);t&&t.getSpec&&(r=t.getSpec().gvlid)}return r},getGvlidForUserIdModule:function(e){return"object"===j(e)?e.gvlid:null},getGvlidForAnalyticsAdapter:function(e){return a.default.getAnalyticsAdapter(e)&&(a.default.getAnalyticsAdapter(e).gvlid||null)}};function H(e){var r=null;if(e){var t=o.b.getConfig("gvlMapping"),n="string"==typeof e?e:e.name;if(t&&t[n])return r=t[n];r=V.getGvlidForBidAdapter(n)||V.getGvlidForUserIdModule(e)||V.getGvlidForAnalyticsAdapter(n)}return r}function R(e,r,t,o){var a=P[Object.keys(P).filter((function(r){return P[r].name===e.purpose}))[0]].id;if(l()(e.vendorExceptions||[],t))return!0;var c=Object(n.deepAccess)(r,"vendorData.purpose.consents.".concat(a)),i=Object(n.deepAccess)(r,"vendorData.vendor.consents.".concat(o)),s=Object(n.deepAccess)(r,"vendorData.purpose.legitimateInterests.".concat(a)),u=!1===e.enforcePurpose||!0===c,p=!1===e.enforceVendor||!0===i;return 2===a?u&&p||!0===s:u&&p}function T(e,r,t,c){if(c=h({},{hasEnforcementHook:!0}),Object(n.hasDeviceAccess)()){var i=a.gdprDataHandler.getConsentData();if(i&&i.gdprApplies)if(2===i.apiVersion){var s=o.b.getCurrentBidder();r=s&&s!=t&&a.default.aliasRegistry[s]===t?H(s):H(t)||r;var l=t||s;R(A,i,l,r)?(c.valid=!0,e.call(this,r,t,c)):(l&&Object(n.logWarn)("TCF2 denied device access for ".concat(l)),c.valid=!1,w.push(l),e.call(this,r,t,c))}else c.valid=!0,e.call(this,r,t,c);else c.valid=!0,e.call(this,r,t,c)}else Object(n.logWarn)("Device access is disabled by Publisher"),c.valid=!1,e.call(this,r,t,c)}function G(e){for(var r=a.gdprDataHandler.getConsentData(),t=arguments.length,c=new Array(t>1?t-1:0),i=1;i<t;i++)c[i-1]=arguments[i];if(r&&r.gdprApplies)if(2===r.apiVersion){var s=o.b.getCurrentBidder(),l=H(s),u=R(A,r,s,l);u?e.call.apply(e,[this].concat(c)):(Object(n.logWarn)("User sync not allowed for ".concat(s)),w.push(s))}else e.call.apply(e,[this].concat(c));else e.call.apply(e,[this].concat(c))}function M(e,r,t){if(t&&t.gdprApplies)if(2===t.apiVersion){var o=r.map((function(e){var r=H(e.submodule),o=e.submodule.name;if(R(A,t,o,r))return e;Object(n.logWarn)("User denied permission to fetch user id for ".concat(o," User id module")),w.push(o)})).filter((function(e){return e}));e.call(this,o,O(O({},t),{},{hasValidated:!0}))}else e.call(this,r,t);else e.call(this,r,t)}function W(e,r){for(var t=a.gdprDataHandler.getConsentData(),o=arguments.length,c=new Array(o>2?o-2:0),i=2;i<o;i++)c[i-2]=arguments[i];t&&t.gdprApplies&&2===t.apiVersion?(r.forEach((function(e){e.bids=e.bids.filter((function(e){var r=e.bidder,o=H(r);if(l()(S,r))return!1;var a=!!R(C,t,r,o);return a||(Object(n.logWarn)("TCF2 blocked auction for ".concat(r)),S.push(r)),a}))})),e.call.apply(e,[this,r].concat(c))):e.call.apply(e,[this,r].concat(c))}function I(e,r){var t=a.gdprDataHandler.getConsentData();t&&t.gdprApplies&&2===t.apiVersion?(Object(n.isArray)(r)||(r=[r]),r=r.filter((function(e){var r=e.provider,o=H(r),a=!!R(D,t,r,o);return a||(F.push(r),Object(n.logWarn)("TCF2 blocked analytics adapter ".concat(e.provider))),a})),e.call(this,r)):e.call(this,r)}b.a.on(v.a.EVENTS.AUCTION_END,(function(){var e=function(e){return e.filter((function(r,t){return null!==r&&e.indexOf(r)===t}))},r={storageBlocked:e(w),biddersBlocked:e(S),analyticsBlocked:e(F)};b.a.emit(v.a.EVENTS.TCF2_ENFORCEMENT,r)}));var N=function(e){return e.purpose===P.purpose1.name},U=function(e){return e.purpose===P.purpose2.name},x=function(e){return e.purpose===P.purpose7.name};function _(e){var r=Object(n.deepAccess)(e,"gdpr.rules");r?E=r:(Object(n.logWarn)("TCF2: enforcing P1 and P2 by default"),E=k),A=i()(E,N),C=i()(E,U),D=i()(E,x),A||(A=k[0]),C||(C=k[1]),A&&!B&&(B=!0,d.d.before(T,49),u.registerSyncInner.before(G,48),Object(p.a)("validateGdprEnforcement").before(M,47)),C&&Object(p.a)("makeBidRequests").before(W),D&&Object(p.a)("enableAnalyticsCb").before(I)}o.b.getConfig("consentManagement",(function(e){return _(e.consentManagement)})),window.pbjs.installedModules.push("gdprEnforcement")}},[350]);