pbjsChunk([91],{831:function(t,e,r){t.exports=r(832)},832:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"DEFAULT_LOCAL_STORAGE_USER_PROFILE_KEY",(function(){return b})),r.d(e,"storage",(function(){return d})),e.getBidRequestData=w,e.setWeboContextualProfile=T,r.d(e,"weboramaSubmodule",(function(){return U}));var n=r(14),a=r(0),o=r(8),c=r(4),i=r(7);function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,a,o=[],c=!0,i=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);c=!0);}catch(t){i=!0,a=t}finally{try{c||null==r.return||r.return()}finally{if(i)throw a}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var f=r(9).default,l="weborama",b="webo_wam2gam_entry",d=Object(i.b)(284,l),g=null,p=!1,O=null,v=!1;var m={setPrebidTargeting:!0,sendToBidders:!0,onData:function(t,e,r){return Object(a.logMessage)("onData(data,kind,default)",t,e,r)}};function h(t,e){Object.entries(m).forEach((function(r){var n=u(r,2),a=n[0],o=n[1];if(!e.hasOwnProperty(a)){var c=t.hasOwnProperty(a);e[a]=c?t[a]:o}}))}function j(t){var e=t.defaultProfile||{};return g||e}function y(t){var e=t.defaultProfile||{};if(d.localStorageIsEnabled()&&!O){var r=t.localStorageProfileKey||b,n=d.getDataFromLocalStorage(r);if(n){var a=JSON.parse(n);a&&Object.keys(a).length>0&&(O=a.targeting)}}return O||e}function w(t,e,r){var o=(r=r||{}).params||{},i=o.weboCtxConf||{},u=t.adUnits||Object(n.a)().adUnits;if(!p)return D(u,o),void e();!function(t,e,r){var n=t.targetURL||document.URL,o=t.token,i="";i=Object(a.tryAppendQueryString)(i,"token",o),i=Object(a.tryAppendQueryString)(i,"url",n);var u="https://ctx.weborama.com/api/profile?".concat(i);Object(c.a)(u,{success:function(t,n){if(200===n.status)try{var o=JSON.parse(t);e(o),r()}catch(t){throw r(),Object(a.logError)("unable to parse weborama data",t),t}else 204===n.status&&r()},error:function(){r(),Object(a.logError)("unable to get weborama data")}},null,{method:"GET",withCredentials:!1})}(i,(function(t){Object(a.logMessage)("fetchContextualProfile on getBidRequestData is done"),T(t)}),(function(){D(u,o),e()}))}function D(t,e){var r=e.weboCtxConf||{},n=e.weboUserDataConf||{},o=r.sendToBidders,c=n.sendToBidders;if(o){var i=j(r);Object(a.isEmpty)(i)||E(t,i,!0)}if(c){var u=y(n);Object(a.isEmpty)(u)||E(t,u,!1)}!function(t,e){[{onData:t.onData,fetchData:function(){return j(t)},site:!0},{onData:e.onData,fetchData:function(){return y(e)},site:!1}].filter((function(t){return Object(a.isFn)(t.onData)})).forEach((function(t){try{var e=t.fetchData();t.onData(e,t.site)}catch(e){var r=t.site?"site":"user";Object(a.logError)("error while executure onData callback with ".concat(r,"-based data:"),e)}}))}(r,n)}function E(t,e,r){!function(t,e){var r="".concat(e?"site":"user",".ext.data"),o={};if(A(o,r,t),!Object(a.isEmpty)(o)){var c=Object(n.a)().getConfig("ortb2")||{},i={ortb2:Object(a.mergeDeep)({},c,o)};Object(n.a)().setConfig(i)}}(e,r),t.forEach((function(t){if(t.hasOwnProperty("bids")){var n=t.code||"no code";t.bids.forEach((function(t){return function(t,e,r,n){var o=P[n.bidder]||n.bidder;switch(Object(a.logMessage)("handling on adunit '".concat(t,"', bidder '").concat(o,"' and bid"),n),o){case C:!function(t,e){A(e,"params.keywords",t)}(e,n);break;case x:!function(t,e){var r="|",n=",",o="params.dctr",c=[],i=Object(a.deepAccess)(e,o);i&&i.split(r).forEach((function(t){return c.push(t)}));Object.keys(t).forEach((function(e){var r=t[e].join(n),a="".concat(e,"=").concat(r);-1===c.indexOf(a)&&c.push(a)})),Object(a.deepSetValue)(e,o,c.join(r))}(e,n);break;case k:!function(t,e){var r=";",n="params.target",o=[],c=Object(a.deepAccess)(e,n);c&&c.split(r).forEach((function(t){return o.push(t)}));Object.keys(t).forEach((function(e){t[e].forEach((function(t){var r="".concat(e,"=").concat(t);-1===o.indexOf(r)&&o.push(r)}))})),Object(a.deepSetValue)(e,n,o.join(r))}(e,n);break;case S:!function(t,e,r){var n="params.".concat(e?"inventory":"visitor");A(r,n,t)}(e,r,n);break;default:Object(a.logMessage)("unsupported bidder '".concat(o,"', trying via bidder ortb2 fpd")),A(n,"ortb2.".concat(r?"site":"user",".ext.data"),e)}}(n,e,r,t)}))}}))}var C="appnexus",x="pubmatic",S="rubicon",k="smartadserver",P=f.aliasRegistry||{};function A(t,e,r){Object.keys(r).forEach((function(n){var o="".concat(e,".").concat(n);Object(a.deepSetValue)(t,o,r[n])}))}function T(t){t&&Object.keys(t).length>0&&(g=t)}var U={name:l,init:function(t){var e=(t=t||{}).params||{},r=e.weboCtxConf,n=e.weboUserDataConf;return p=function(t,e){if(!e||!1===e.enabled)return t.weboCtxConf=null,!1;if(h(t,e),p=!1,g=null,!e.token)return Object(a.logWarn)('missing param "token" for weborama contextual sub module initialization'),!1;return Object(a.logMessage)("weborama contextual intialized with success"),!0}(e,r),v=function(t,e){if(!e||!1===e.enabled)return t.weboUserDataConf=null,!1;h(t,e),v=!1,O=null;var r="weborama user-centric intialized with success";e.hasOwnProperty("accountId")&&(r="weborama user-centric intialized with success for account: ".concat(e.accountId));return Object(a.logMessage)(r),!0}(e,n),p||v},getTargetingData:function(t,e){var r=(e=e||{}).params||{},n=r.weboCtxConf||{},o=r.weboUserDataConf||{},c=n.setPrebidTargeting,i=o.setPrebidTargeting;try{var u=function(t,e,r){var n={};if(e){var o=j(t.weboCtxConf||{});Object(a.mergeDeep)(n,o)}if(r){var c=y(t.weboUserDataConf||{});Object(a.mergeDeep)(n,c)}return n}(r,c,i);return Object(a.isEmpty)(u)?{}:t.reduce((function(t,e){return e&&(t[e]=u),t}),{})}catch(t){return Object(a.logError)("unable to format weborama rtd targeting data",t),{}}},getBidRequestData:w};Object(o.e)("realTimeData",U),window.pbjs.installedModules.push("weboramaRtdProvider")}},[831]);