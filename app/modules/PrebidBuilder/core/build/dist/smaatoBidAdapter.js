pbjsChunk([140],{708:function(e,t,r){e.exports=r(709)},709:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"spec",(function(){return l}));var a=r(0),n=r(1),i=r(3),o=r(2);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var s="prebid_js_6.10.0-pre_1.6",p="USD",u=function(e,t){var r={id:t.auctionId,at:1,cur:[p],tmax:t.timeout,site:{id:window.location.hostname,publisher:{id:Object(a.deepAccess)(e,"params.publisherId")},domain:window.location.hostname,page:window.location.href,ref:t.refererInfo.referer},device:{language:navigator&&navigator.language?navigator.language.split("-")[0]:"",ua:navigator.userAgent,dnt:Object(a.getDNT)()?1:0,h:screen.height,w:screen.width},regs:{coppa:!0===i.b.getConfig("coppa")?1:0,ext:{}},user:{ext:{}},source:{ext:{schain:e.schain}},ext:{client:s}},n=i.b.getConfig("ortb2")||{};if(d(r.user,n.user),d(r.site,n.site),t.gdprConsent&&!0===t.gdprConsent.gdprApplies&&(Object(a.deepSetValue)(r,"regs.ext.gdpr",t.gdprConsent.gdprApplies?1:0),Object(a.deepSetValue)(r,"user.ext.consent",t.gdprConsent.consentString)),void 0!==t.uspConsent&&Object(a.deepSetValue)(r,"regs.ext.us_privacy",t.uspConsent),Object(a.deepAccess)(e,"params.app")){var c=Object(a.deepAccess)(e,"params.app.geo");Object(a.deepSetValue)(r,"device.geo",c);var u=Object(a.deepAccess)(e,"params.app.ifa");Object(a.deepSetValue)(r,"device.ifa",u)}var l=Object(a.deepAccess)(e,"userIdAsEids");l&&l.length&&Object(a.deepSetValue)(r,"user.ext.eids",l);var m=[];if(Object(a.deepAccess)(e,"mediaTypes.banner")){var b=d({},r,function(e){var t=Object(a.getAdUnitSizes)(e),r=t.map((function(e){return{w:e[0],h:e[1]}}));return{imp:[{id:e.bidId,tagid:Object(a.deepAccess)(e,"params.adspaceId"),bidfloor:g(e,o.b,t),instl:Object(a.deepAccess)(e.ortb2Imp,"instl"),banner:{w:r[0].w,h:r[0].h,format:r}}]}}(e));m.push(b)}var h=Object(a.deepAccess)(e,"mediaTypes.video");if(h)if(h.context===o.a){var v=d({},r,function(e,t){var r=Object(a.deepAccess)(e,"params.adbreakId"),n=i.b.getConfig("adpod.brandCategoryExclusion"),c={id:e.bidId,tagid:r,bidfloor:g(e,o.d,t.playerSize),instl:Object(a.deepAccess)(e.ortb2Imp,"instl"),video:{w:t.playerSize[0][0],h:t.playerSize[0][1],mimes:t.mimes,startdelay:t.startdelay,linearity:t.linearity,skip:t.skip,protocols:t.protocols,skipmin:t.skipmin,api:t.api,ext:{context:o.a,brandcategoryexclusion:void 0!==n&&n}}},d=function(e){var t=e.adPodDurationSec,r=e.durationRangeSec,n=e.requireExactDuration,i=Object(a.getMinValueFromArray)(r),o=Math.floor(t/i);return n?Math.max(o,r.length):o}(t),s=Object(a.fill)(c,d),p=t.durationRangeSec;if(t.requireExactDuration){var u=Math.ceil(d/p.length),l=Object(a.chunk)(s,u);p.forEach((function(e,t){l[t].map((function(r){var a=t+1;r.video.minduration=e,r.video.maxduration=e,r.video.sequence=a}))}))}else{var m=Object(a.getMaxValueFromArray)(p);s.map((function(e,t){var r=t+1;e.video.maxduration=m,e.video.sequence=r}))}return{imp:s}}(e,h));f(v,h),m.push(v)}else{var y=d({},r,function(e,t){return{imp:[{id:e.bidId,tagid:Object(a.deepAccess)(e,"params.adspaceId"),bidfloor:g(e,o.d,t.playerSize),instl:Object(a.deepAccess)(e.ortb2Imp,"instl"),video:{mimes:t.mimes,minduration:t.minduration,startdelay:t.startdelay,linearity:t.linearity,w:t.playerSize[0][0],h:t.playerSize[0][1],maxduration:t.maxduration,skip:t.skip,protocols:t.protocols,ext:{rewarded:t.ext&&t.ext.rewarded?t.ext.rewarded:0},skipmin:t.skipmin,api:t.api}}]}}(e,h));m.push(y)}return m},l={code:"smaato",supportedMediaTypes:[o.b,o.d],isBidRequestValid:function(e){if("object"!==c(e.params))return Object(a.logError)("[SMAATO] Missing params object"),!1;if("string"!=typeof e.params.publisherId)return Object(a.logError)("[SMAATO] Missing mandatory publisherId param"),!1;if(Object(a.deepAccess)(e,"mediaTypes.video.context")===o.a){if(Object(a.logInfo)("[SMAATO] Verifying adpod bid request"),"string"!=typeof e.params.adbreakId)return Object(a.logError)("[SMAATO] Missing for adpod request mandatory adbreakId param"),!1;if(e.params.adspaceId)return Object(a.logError)("[SMAATO] The adspaceId param is not allowed in an adpod bid request"),!1}else{if(Object(a.logInfo)("[SMAATO] Verifying a non adpod bid request"),"string"!=typeof e.params.adspaceId)return Object(a.logError)("[SMAATO] Missing mandatory adspaceId param"),!1;if(e.params.adbreakId)return Object(a.logError)("[SMAATO] The adbreakId param is only allowed in an adpod bid request"),!1}return Object(a.logInfo)("[SMAATO] Verification done, all good"),!0},buildRequests:function(e,t){return Object(a.logInfo)("[SMAATO] Client version:",s),e.map((function(e){return u(e,t).map((function(t){return function(e,t){return Object(a.logInfo)("[SMAATO] OpenRTB Request:",t),{method:"POST",url:e.params.endpoint||"https://prebid.ad.smaato.net/oapi/prebid",data:JSON.stringify(t),options:{withCredentials:!0,crossOrigin:!0}}}(e,t)}))})).reduce((function(e,t){return null!=t&&e.concat(t)}),[])},interpretResponse:function(e,t){if(Object(a.isEmpty)(e.body))return Object(a.logInfo)("[SMAATO] Empty response body HTTP 204, no bids"),[];var r=e.headers,n=r.get("X-SMT-Expires");Object(a.logInfo)("[SMAATO] Expires:",n);var c=n?Math.floor((n-Date.now())/1e3):300,d=e.body;Object(a.logInfo)("[SMAATO] OpenRTB Response:",d);var s=r.get("X-SMT-ADTYPE"),p=[];return d.seatbid.forEach((function(e){e.bid.forEach((function(r){var n={requestId:r.impid,cpm:r.price||0,width:r.w,height:r.h,ttl:c,creativeId:r.crid,dealId:r.dealid||null,netRevenue:Object(a.deepAccess)(r,"ext.net",!0),currency:d.cur,meta:{advertiserDomains:r.adomain,networkName:r.bidderName,agencyId:e.seat}};if(Object(a.deepAccess)(JSON.parse(t.data).imp[0],"video.ext.context")===o.a)n.vastXml=r.adm,n.mediaType=o.d,i.b.getConfig("adpod.brandCategoryExclusion")&&(n.meta.primaryCatId=r.cat[0]),n.video={context:o.a,durationSeconds:r.ext.duration},p.push(n);else switch(s){case"Img":n.ad=m(r.adm),n.mediaType=o.b,p.push(n);break;case"Richmedia":n.ad=b(r.adm),n.mediaType=o.b,p.push(n);break;case"Video":n.vastXml=r.adm,n.mediaType=o.d,p.push(n);break;default:Object(a.logInfo)("[SMAATO] Invalid ad type:",s)}n.meta.mediaType=n.mediaType}))})),Object(a.logInfo)("[SMAATO] Prebid bids:",p),p},getUserSyncs:function(e,t,r,a){return[]}};Object(n.registerBidder)(l);var m=function(e){var t=JSON.parse(e).image,r="";t.clicktrackers.forEach((function(e){r+="fetch(decodeURIComponent('".concat(encodeURIComponent(e),"'), {cache: 'no-cache'});")}));var a='<div style="cursor:pointer" onclick="'.concat(r,";window.open(decodeURIComponent('").concat(encodeURIComponent(t.img.ctaurl),'\'));"><img src="').concat(t.img.url,'" width="').concat(t.img.w,'" height="').concat(t.img.h,'"/>');return t.impressiontrackers.forEach((function(e){a+='<img src="'.concat(e,'" alt="" width="0" height="0"/>')})),a+"</div>"},b=function(e){var t=JSON.parse(e).richmedia,r="";t.clicktrackers.forEach((function(e){r+="fetch(decodeURIComponent('".concat(encodeURIComponent(e),"'), {cache: 'no-cache'});")}));var a='<div onclick="'.concat(r,'">').concat(t.mediadata.content);return t.impressiontrackers.forEach((function(e){a+='<img src="'.concat(e,'" alt="" width="0" height="0"/>')})),a+"</div>"};var f=function(e,t){var r={};t.tvSeriesName&&(r.series=t.tvSeriesName),t.tvEpisodeName&&(r.title=t.tvEpisodeName),"number"==typeof t.tvSeasonNumber&&(r.season=t.tvSeasonNumber.toString()),"number"==typeof t.tvEpisodeNumber&&(r.episode=t.tvEpisodeNumber),"number"==typeof t.contentLengthSec&&(r.len=t.contentLengthSec),t.contentMode&&["live","on-demand"].indexOf(t.contentMode)>=0&&(r.livestream="live"===t.contentMode?1:0),Object(a.isEmpty)(r)||(e.site.content=r)};function g(e,t,r){if("function"==typeof e.getFloor){var a=1===r.length?r[0]:"*",n=e.getFloor({currency:p,mediaType:t,size:a});if(n&&!isNaN(n.floor)&&n.currency===p)return n.floor}}window.pbjs.installedModules.push("smaatoBidAdapter")}},[708]);